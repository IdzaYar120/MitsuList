{% extends 'base.html' %}
{% load static i18n %}

{% block title %}Discover - MitsuList{% endblock %}

{% block content %}
<div style="max-width: 1200px; margin: 40px auto; padding: 0 20px;">
    
    <div style="margin-bottom: 30px; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 20px;">
        <h2 style="font-family: var(--font-header); font-size: 2.2rem; margin-bottom: 10px; display: flex; align-items: center; gap: 15px;">
            <i class="fa-solid fa-compass" style="color: var(--color-accent);"></i> Discover
        </h2>
        <p style="color: var(--color-muted); font-size: 1.1rem; max-width: 800px;">
            Personalized recommendations based on the anime you've highly rated or recently completed. The more you watch and score, the better these suggestions become!
        </p>
    </div>

    <!-- Recommendations Grid -->
    <div style="margin-top: 40px;">
        {% if recommendations %}
            <div id="search-results-container" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 25px;">
                {% for item in recommendations %}
                    <a href="{% url 'anime-view' item.anime.mal_id %}" class="anime-card-links" style="position: relative; display: block;">
                        <div class="anime-cards" style="height: 100%; display: flex; flex-direction: column;">
                            
                            <!-- Image -->
                            <div style="position: relative; padding-top: 140%; border-radius: var(--border-radius); overflow: hidden; margin-bottom: 15px; box-shadow: 0 4px 15px var(--color-shadow);">
                                <img src="{{ item.anime.images.jpg.large_image_url }}" alt="{{ item.anime.title }}" loading="lazy"
                                     style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; transition: transform 0.3s ease;">
                            </div>
                            
                            <!-- Title -->
                            <p class="anime-title" style="flex-grow: 1; margin: 0 0 10px 0; font-size: 1rem; line-height: 1.3;">
                                {{ item.anime.title }}
                            </p>
                            
                            <!-- Context Tag -->
                            <div style="background: rgba(123, 47, 247, 0.15); border: 1px solid rgba(123, 47, 247, 0.3); border-radius: 6px; padding: 8px; font-size: 0.75rem; color: var(--color-text); line-height: 1.2;">
                                <i class="fa-solid fa-lightbulb" style="color: var(--color-accent); margin-right: 5px;"></i>
                                {{ item.context }}
                            </div>
                            
                        </div>
                    </a>
                {% endfor %}
            </div>
        {% else %}
             <div style="text-align: center; padding: 60px 20px; background: var(--glass-bg); border-radius: var(--border-radius); border: 1px dashed rgba(255,255,255,0.1);">
                <i class="fa-solid fa-ghost" style="font-size: 4rem; color: var(--color-muted); margin-bottom: 20px;"></i>
                <h3 style="color: var(--color-text); font-family: var(--font-header); font-size: 1.5rem; margin-bottom: 10px;">Not enough data yet</h3>
                <p style="color: var(--color-muted); max-width: 500px; margin: 0 auto;">
                    We need a bit more info to recommend anime for you. Try adding some shows you've completed to your list and give them a score!
                </p>
                <a href="{% url 'home' %}" class="mitsulist-btn-primary" style="display: inline-block; margin-top: 25px; text-decoration: none;">Explore Popular Anime</a>
            </div>
        {% endif %}
    </div>

</div>

<!-- Hover effects for the anime cards -->
<style>
    .anime-card-links:hover img {
        transform: scale(1.05);
    }
    .anime-card-links:hover .anime-title {
        color: var(--color-accent);
    }
</style>
{% endblock %}
