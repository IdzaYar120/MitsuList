{% extends 'base.html' %}
{% load static i18n %}

{% block title %}{% trans "Enter New Password" %} - MitsuList{% endblock %}

{% block content %}
<div style="display: flex; justify-content: center; align-items: center; min-height: 70vh; padding: 20px;">
    <div style="background: var(--glass-bg); padding: 40px; border-radius: 16px; border: 1px solid rgba(255,255,255,0.1); width: 100%; max-width: 450px; box-shadow: 0 10px 30px rgba(0,0,0,0.3);">
        
        {% if validlink %}
            <div style="text-align: center; margin-bottom: 30px;">
                <i class="fa-solid fa-key" style="font-size: 3rem; color: #ff9ff3; margin-bottom: 15px;"></i>
                <h2 style="font-family: var(--font-header); font-size: 1.8rem; margin: 0; color: white;">{% trans "Set a new password" %}</h2>
                <p style="color: var(--color-muted); margin-top: 10px; font-size: 0.95rem;">
                    {% trans "Please enter your new password twice so we can verify you typed it in correctly." %}
                </p>
            </div>

            <form method="post">
                {% csrf_token %}
                
                {% for field in form %}
                <div style="margin-bottom: 20px;">
                    <label for="{{ field.id_for_label }}" style="display: block; color: var(--color-muted); font-size: 0.9rem; margin-bottom: 8px;">{{ field.label }}</label>
                    
                    {{ field.errors }}
                    <input type="{{ field.field.widget.input_type }}" name="{{ field.name }}" id="{{ field.id_for_label }}" required
                           style="width: 100%; padding: 12px 15px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.2); background: rgba(0,0,0,0.3); color: white; box-sizing: border-box; transition: 0.2s; outline: none;"
                           onfocus="this.style.borderColor='#ff9ff3'" 
                           onblur="this.style.borderColor='rgba(255,255,255,0.2)'">
                </div>
                {% endfor %}

                <button type="submit" class="mitsulist-btn-primary" style="width: 100%; padding: 12px; font-size: 1rem; border-radius: 8px; border: none; font-weight: bold; cursor: pointer; transition: 0.3s; background: linear-gradient(135deg, #ff9ff3, #7b2ff7);">
                    <i class="fa-solid fa-check" style="margin-right: 8px;"></i> {% trans "Change Password" %}
                </button>
            </form>
        {% else %}
            <div style="text-align: center;">
                <i class="fa-solid fa-circle-exclamation" style="font-size: 4rem; color: #ff4757; margin-bottom: 20px;"></i>
                <h2 style="font-family: var(--font-header); font-size: 1.8rem; margin: 0 0 15px 0; color: white;">{% trans "Invalid Link" %}</h2>
                <p style="color: var(--color-muted); font-size: 1rem; line-height: 1.6; margin-bottom: 30px;">
                    {% trans "The password reset link was invalid, possibly because it has already been used. Please request a new password reset." %}
                </p>
                <a href="{% url 'password_reset' %}" class="mitsulist-btn-primary" style="text-decoration: none; display: inline-block; padding: 10px 25px; border-radius: 8px;">
                    {% trans "Request New Link" %}
                </a>
            </div>
        {% endif %}
    </div>
</div>
{% endblock %}
